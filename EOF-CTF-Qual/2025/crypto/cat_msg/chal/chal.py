from sage.all import *
import secrets

with open('flag.txt', 'rb') as meEoooW:
    meOwO = meEoooW.read()

# "meOwO" is "flag" in MeowLish
meOwO = [int(bit) for byte in meOwO for bit in f'{byte:08b}']

R  = PolynomialRing(ZZ, names=('meowingcat',)); (meowingcat,) = R._first_ngens(1)
MmMeoOOOoOoW = 10413259884191656339071716260830970594019380678633640710598727433295926285347918708292004016490651932000*meowingcat**7 + 252494110674012002541514797764827158724121386633059451594119818010148193281592400026520593213461099399038944073486*meowingcat**6 + 14529160840260745786509496359724356787188326132801486485566133985535665069892295966690495950982676949536238346962*meowingcat**5 + 95515120986975418742780707357913088549131357305328369209808244591545738634309873996623254051815891755018401343856*meowingcat**4 + 65176268221379786971773925764775296541697077770744636064225970565945754418513311940786569146293497193663533010652*meowingcat**3 + 180776214508546762217902706989924469079606298223767170020347719086675964795206127649700412230279249284690008979158*meowingcat**2 + 233302413192532175819496609029797143533434993955387323269458143291245908014630929176027926621738749425901291228018*meowingcat + 143491234406688723416490898601225309678343916741387556923054435686233973323559376474177051270543031936592520011397
MmMeoOOOoOow = 3471086628063885446357238753610323531339793559544546903532909144431975428449306236097334672163550644000*meowingcat**7 + 84164703558004000847171599254942386241373795544353150531373272670049397760530800008840197737820366466346314691162*meowingcat**6 + 91064528951076613265720743351539296774527279629238715675150132217418711139411039580553128030185345691325519935046*meowingcat**5 + 31838373662325139580926902452637696183043785768442789736602748197181912878103291332207751350605297251672800447952*meowingcat**4 + 21725422740459928990591308588258432180565692590248212021408656855315251472837770646928856382097832397887844336884*meowingcat**3 + 232701688844828316746402724793237178717464441244532163700038748140038967163962591066546062836475323177856883965170*meowingcat**2 + 250210421739490121280267358806528070202074006488405548116408889541562281570437524908655234300295156558260644714790*meowingcat + 220273362144208970479265455330337458917043647417072292667607653673224970006747007341371609183229917395181118430820

MeowMeOwmeoWw = 258664426012969094010652733694893533536393512754914660539884262666720468348340822774968888139573360124440321458177
MeowMeOwMeOoW = 1
MeowMeOwmEOWMEOw = EllipticCurve(GF(MeowMeOwmeoWw), [0, 0, 0, 0, MeowMeOwMeOoW])
mmEow = MeowMeOwmEOWMEOw(211327896882745355133216154117765694506824267591963425810864360539127436927129408124317179524815263831669171942288, 242000360178127454722920758782320325120065800315232786687003874687882586608857040803085327019415054542726981896082)
mmEoW = MeowMeOwmEOWMEOw(141078002483297354166779897252895086829637396399741587968861330915310465563157775245215359678414439802307293763593, 21987419692484616093788518727313616089990324856173653004512069981050648496581282307403640131128425072464960150591)

def MEOw(MeoooWmeow, MeoooWmeoW, meOwO = 0):
    uwub = secrets.randbelow(MeowMeOwmeoWw)
    return (MmMeoOOOoOow(MeoooWmeow) + (1 - meOwO) * uwub) * mmEow + (MmMeoOOOoOoW(MeoooWmeoW) + (meOwO) * uwub) * mmEoW

# many people told me to leave some comments in my codes or else it would be unreadable
# Meow Meow Meow Meow im not a cat but MEOW!!!

print("=" * 33 , "Meow mEOw MeOw MeOW mEow!!!", "="*33) # Welcome to the cats channel!!!

print("mmEow:", hex(mmEow.xy()[0]))
print("mmEoW:", hex(mmEoW.xy()[0]))

# In this case, two cats catcat and catcatcat are generating their keys with there secret keys!

for MeOw in meOwO: # MeOw = cats' decision
    meoW = secrets.randbelow(MeowMeOwmeoWw)
    print("MeeOw MeeOw > ")
    print(hex(MEOw(secrets.randbelow(MeowMeOwmeoWw), meoW, meOwO = MeOw^1).xy()[0]))
    print("MeeOw MeeOw MeeOw > ")
    print(hex(MEOw(meoW, secrets.randbelow(MeowMeOwmeoWw), meOwO = MeOw^0).xy()[0]))

print("=" * 33, "EOF", "=" * 33)

# I think cats are the tirest animal of all ... because every linux users use them to read a file
# let's "alias meow='echo meow~!'"
