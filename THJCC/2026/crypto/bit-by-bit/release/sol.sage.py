

# This file was *autogenerated* from the file sol.sage
from sage.all_cmdline import *   # import sage library

_sage_const_0 = Integer(0); _sage_const_1 = Integer(1); _sage_const_2 = Integer(2); _sage_const_0x10001 = Integer(0x10001); _sage_const_30 = Integer(30); _sage_const_70 = Integer(70); _sage_const_100 = Integer(100)
from Crypto.Util.number import *
import json

with open('output.txt', 'r') as f:
    datas = json.load(f)

cs = []
Ns = []

def get_flag(key):
    flag = _sage_const_0 
    global cs, Ns
    for i in range(len(cs)):
        if int(bytes_to_long(key)) % Ns[i] == int(cs[i]):
            flag += _sage_const_1 
        if i!=len(cs)-_sage_const_1 :
            flag *= _sage_const_2 
    print(long_to_bytes(flag))

for cur_data in datas:
    cur_N = cur_data[_sage_const_1 ]
    cur_c = cur_data[_sage_const_0 ]
    cur_d = pow(_sage_const_0x10001 , -_sage_const_1 , euler_phi(cur_N))
    Ns.append(cur_N)
    cs.append(int(pow(cur_c, cur_d, cur_N)))

R=crt(cs, Ns)
N = _sage_const_1 

for i in Ns:
    N*=i

P = PolynomialRing(Zmod(N), names=('x',)); (x,) = P._first_ngens(1)
f = x-R

for i in range(_sage_const_30 , _sage_const_70 ):
    key = f.small_roots(beta=i/_sage_const_100 )
    print(i)
    if len(key)>_sage_const_0 :
        cur_key = long_to_bytes(int(key[_sage_const_0 ]))
        print(cur_key, len(cur_key))
        print(get_flag(cur_key))

